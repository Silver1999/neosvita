$(document).ready(function(){$(".group__switch").click(function(i){var e=$(i.target);if(e.is(".group__switchCase")){e.siblings().removeClass("active").end().addClass("active");var t=$("."+$(this).data("table"));t.find(".visible").removeClass("visible"),t.find("."+e.data("col")).addClass("visible")}}),$(".group__editEdit").click(function(){$(this).hide().siblings(".group__removeGroup, .group__changeGrName").hide().end().siblings(".group__editCancel, .group__editSubmit").show(),$("#groupContent .editable .group__text").each(function(){$(this).hide().siblings(".group__input").val($(this).html()).show()}).siblings(".group__grant").each(function(){"ТАК"==$(this).siblings(".group__text").text()?$(this).find(".radioYES").prop("checked",!0):$(this).find(".radioNO").prop("checked",!0),$(this).show()})}),$(".group__editCancel").click(function(){$(this).hide().siblings(".group__editSubmit").hide().siblings(".group__removeGroup, .group__changeGrName, .group__editEdit").show(),$("#groupContent .group__text").show().siblings(".group__input, .group__grant").hide()}),$(".group__editSubmit").click(function(){var i=function(){var n=new Array;return $(".userRow.editable").each(function(){var i=!1,e={};e.id=$(this).data("id");var t=$(this).find(".userDofB");e.dofb=t.val().trim(),i||e.dofb==t.siblings(".group__text").html()||(i=!0),t=$(this).find(".userPhone"),e.phone=t.val().trim(),i||e.phone==t.siblings(".group__text").html()||(i=!0),t=$(this).find(".userEmail"),e.email=t.val().trim(),i||e.email==t.siblings(".group__text").html()||(i=!0),t=$(this).find(".userAddressOfResidence"),e.addressOfResidence=t.val().trim(),i||e.addressOfResidence==t.siblings(".group__text").html()||(i=!0),t=$(this).find(".userAddressOfRegistration"),e.addressOfRegistration=t.val().trim(),i||e.addressOfRegistration==t.siblings(".group__text").html()||(i=!0),t=$(this).find(".userParentName1"),e.parentName1=t.val().trim(),i||e.parentName1==t.siblings(".group__text").html()||(i=!0),t=$(this).find(".userParentName2"),e.parentName2=t.val().trim(),i||e.parentName2==t.siblings(".group__text").html()||(i=!0),t=$(this).find(".userParentPhone"),e.parentPhone=t.val().trim(),i||e.parentPhone==t.siblings(".group__text").html()||(i=!0),$(this).find(".group__grant").each(function(){e.grant=$(this).find("input:checked").val(),i||$(this).siblings(".group__text").text()==$(this).find("input:checked").data("val")||(i=!0)}),i&&n.push(e)}),$.isEmptyObject(n)?"":n}();i&&$.post("groupUpdate",JSON.stringify(i)).done(function(i){"ok"==i&&($("#groupContent .group__input").each(function(){$(this).hide().siblings(".group__text").html($(this).val()).show()}),$("#groupContent .group__grant").each(function(){$(this).hide().siblings(".group__text").html($(this).find("input:checked").data("val")).show()}),$(".group__editCancel, .group__editSubmit").hide().siblings(".group__removeGroup, .group__changeGrName, .group__editEdit").show())}).fail(function(){alert("Виникла помилка. Дані ще не введено.")})}),$(".group__delete").click(function(){var i=$(this).siblings(".userName").text();$("#overlay").show().find(".modalRemoveUser").show().find(".userName").html(i).end().find(".btnRemoveUser").data("id",$(this).data("id"))}),$(".group__removeGroup").click(function(){$("#overlay").show().find(".modalRemoveGroup").show()}),$(".group__changeGrName").click(function(){$("#overlay").show().find(".modalChangeGrName").show().find(".error").removeClass("error")}),$(".modal__button.button-cancel").click(function(){$("#overlay").hide().find(".modal").hide()}),$(".userDofB").focus(function(){$(this).addClass("edited");new Cleave(".userDofB.edited",{date:!0,delimiter:"-",datePattern:["d","m","Y"]})}).blur(function(){$(this).removeClass("edited")}),$(".btnRemoveUser").click(function(){var e={id:$(this).data("id")};$.post("userRemove",JSON.stringify(e)).done(function(i){"ok"==i&&($("#overlay").hide().find(".modalRemoveUser").hide(),$(".userRow[data-id="+e.id+"]").remove())}).fail(function(){alert("Виникла помилка.")})}),$(".btnRemoveGroup").click(function(){var i={id:$(this).data("id")};$.post("groupRemove",JSON.stringify(i)).done(function(i){"ok"==i?($("#overlay").hide().find(".modalRemoveGroup").hide(),$("#groupContent").html("")):"reload"==i&&window.location.reload(!0)}).fail(function(){alert("Виникла помилка.")})}),$(".btnChangeGrName").click(function(){var i=$(this).parent().siblings(".modal__newGrName"),e=i.val().trim();if(e.length<4)i.addClass("error");else{i.removeClass("error");var t={id:$(this).data("id"),newName:e};$.post("chnggrname",JSON.stringify(t)).done(function(i){"ok"==i&&$("#overlay").hide().find(".modalChangeGrName").hide()}).fail(function(){alert("Виникла помилка.")})}})});